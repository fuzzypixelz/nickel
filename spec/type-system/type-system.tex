% generated by Ott 0.31 from: grammar.ott rules.ott
\documentclass[11pt]{article}
\usepackage{amsmath,amssymb}
\usepackage{supertabular}
\usepackage{geometry}
\usepackage{ifthen}
\usepackage{alltt}%hack
\geometry{a4paper,dvips,twoside,left=22.5mm,right=22.5mm,top=20mm,bottom=30mm}
\usepackage{color}
\newcommand{\ottdrule}[4][]{{\displaystyle\frac{\begin{array}{l}#2\end{array}}{#3}\quad\ottdrulename{#4}}}
\newcommand{\ottusedrule}[1]{\[#1\]}
\newcommand{\ottpremise}[1]{ #1 \\}
\newenvironment{ottdefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]}{}
\newenvironment{ottfundefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]\begin{displaymath}\begin{array}{l}}{\end{array}\end{displaymath}}
\newcommand{\ottfunclause}[2]{ #1 \equiv #2 \\}
\newcommand{\ottnt}[1]{\mathit{#1}}
\newcommand{\ottmv}[1]{\mathit{#1}}
\newcommand{\ottkw}[1]{\mathbf{#1}}
\newcommand{\ottsym}[1]{#1}
\newcommand{\ottcom}[1]{\text{#1}}
\newcommand{\ottdrulename}[1]{\textsc{#1}}
\newcommand{\ottcomplu}[5]{\overline{#1}^{\,#2\in #3 #4 #5}}
\newcommand{\ottcompu}[3]{\overline{#1}^{\,#2<#3}}
\newcommand{\ottcomp}[2]{\overline{#1}^{\,#2}}
\newcommand{\ottgrammartabular}[1]{\begin{supertabular}{llcllllll}#1\end{supertabular}}
\newcommand{\ottmetavartabular}[1]{\begin{supertabular}{ll}#1\end{supertabular}}
\newcommand{\ottrulehead}[3]{$#1$ & & $#2$ & & & \multicolumn{2}{l}{#3}}
\newcommand{\ottprodline}[6]{& & $#1$ & $#2$ & $#3 #4$ & $#5$ & $#6$}
\newcommand{\ottfirstprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottlongprodline}[2]{& & $#1$ & \multicolumn{4}{l}{$#2$}}
\newcommand{\ottfirstlongprodline}[2]{\ottlongprodline{#1}{#2}}
\newcommand{\ottbindspecprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottprodnewline}{\\}
\newcommand{\ottinterrule}{\\[5.0mm]}
\newcommand{\ottafterlastrule}{\\}
\newcommand{\ottmetavars}{
\ottmetavartabular{
 $ \ottmv{var} ,\, \ottmv{x} ,\, \ottmv{y} ,\, \ottmv{z} $ &  \\
 $ \ottmv{uvar} ,\, {?a} ,\, {?b} $ &  \\
 $ \ottmv{labels} ,\, \ottmv{l} ,\, \ottmv{l'} $ &  \\
 $ \ottmv{typevar} ,\, \alpha ,\, \beta ,\, \gamma $ &  \\
 $ \ottmv{rowvar} ,\, \theta ,\, \iota $ &  \\
 $ \ottmv{i} ,\, \ottmv{j} ,\, \ottmv{k} ,\, \ottmv{n} ,\, \ottmv{m} $ &  \\
}}

\newcommand{\otttypeXXvars}{
\ottrulehead{\ottnt{type\_vars}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\alpha_{{\mathrm{1}}} \, ... \, \alpha_{\ottmv{n}}}{}{}{}{}}

\newcommand{\ottrowXXvars}{
\ottrulehead{\ottnt{row\_vars}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\theta_{{\mathrm{1}}} \, ... \, \theta_{\ottmv{n}}}{}{}{}{}}

\newcommand{\ottrowsXXnotail}{
\ottrulehead{\rho}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{empty}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, ... \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{:}  \sigma_{\ottmv{n}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho  \ottsym{,}  \ottmv{l}  \ottsym{:}  \sigma}{}{}{}{}}

\newcommand{\ottrowsXXenumXXnotail}{
\ottrulehead{\chi}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{empty}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{l_{{\mathrm{1}}}}  \ottsym{,} \, ... \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\chi  \ottsym{,}  \ottmv{l}}{}{}{}{}}

\newcommand{\ottrows}{
\ottrulehead{\ottnt{rows}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\rho}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho  \mid  \theta}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho  \mid \, \ottkw{Dyn}}{}{}{}{}}

\newcommand{\ottrowsXXenum}{
\ottrulehead{\ottnt{rows\_enum}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\chi}{}{}{}{}\ottprodnewline
\ottprodline{|}{\chi  \mid  \theta}{}{}{}{}}

\newcommand{\otttXXmono}{
\ottrulehead{\rho}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{Dyn}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\alpha}{}{}{}{}\ottprodnewline
\ottprodline{|}{\theta}{}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma_{{\mathrm{1}}}  \to  \sigma_{{\mathrm{2}}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ottnt{rows}  \ottsym{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \sigma  \ottsym{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{<}  \ottnt{rows\_enum}  \ottsym{>}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Array} \, \sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\#}  \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \rho  \ottsym{)}} {\textsf{S}}{}{}{}}

\newcommand{\ottt}{
\ottrulehead{\sigma  ,\ \tau }{::=}{}\ottprodnewline
\ottfirstprodline{|}{ \rho }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \forall \ottnt{type\_vars} {.} \rho }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \forall \ottnt{row\_vars} {.} \rho }{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \sigma  \ottsym{)}} {\textsf{S}}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma  \ottsym{[}  \tau   \ottsym{/}  \alpha  \ottsym{]}} {\textsf{M}}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma  \ottsym{[}  \ottnt{rows}  \ottsym{/}  \theta  \ottsym{]}} {\textsf{M}}{}{}{}}

\newcommand{\ottrowsXXnotailXXunif}{
\ottrulehead{\rho}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{empty}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, ... \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{:}  \sigma_{\ottmv{n}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho  \ottsym{,}  \ottmv{l}  \ottsym{:}  \sigma}{}{}{}{}}

\newcommand{\ottrowsXXunif}{
\ottrulehead{\ottnt{rows\_unif}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\rho}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho  \mid  \theta}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho  \mid \, \ottkw{Dyn}}{}{}{}{}}

\newcommand{\otttXXunifXXmono}{
\ottrulehead{\rho}{::=}{}\ottprodnewline
\ottfirstprodline{|}{{?a}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Dyn}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\alpha}{}{}{}{}\ottprodnewline
\ottprodline{|}{\theta}{}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma  \to  \tau}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ottnt{rows\_unif}  \ottsym{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \sigma  \ottsym{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{<}  \ottnt{rows\_enum}  \ottsym{>}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{Array} \, \sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\#}  \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \rho  \ottsym{)}} {\textsf{S}}{}{}{}\ottprodnewline
\ottprodline{|}{\rho  \ottsym{[} \, \ottkw{u\_unif\_mono} \, \ottsym{/}  \alpha  \ottsym{]}} {\textsf{M}}{}{}{}\ottprodnewline
\ottprodline{|}{\rho  \ottsym{[}  \ottnt{rows\_unif}  \ottsym{/}  \theta  \ottsym{]}} {\textsf{M}}{}{}{}}

\newcommand{\otttXXunif}{
\ottrulehead{\sigma  ,\ \tau}{::=}{}\ottprodnewline
\ottfirstprodline{|}{ \rho }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \forall \ottnt{type\_vars} {.} \rho }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \forall \ottnt{row\_vars} {.} \rho }{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \sigma  \ottsym{)}} {\textsf{S}}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma  \ottsym{[}  \tau  \ottsym{/}  \alpha  \ottsym{]}} {\textsf{M}}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma  \ottsym{[}  \ottnt{rows\_unif}  \ottsym{/}  \theta  \ottsym{]}} {\textsf{M}}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma_{{\mathrm{1}}} \, \lor \, .. \, \lor \, \sigma_{\ottmv{n}}} {\textsf{M}}{}{}{}}

\newcommand{\otte}{
\ottrulehead{\ottnt{e}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{null}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{x}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{h} \, \ottnt{e_{{\mathrm{1}}}} \, ... \, \ottnt{e_{\ottmv{n}}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{e}  \ottsym{.}  \ottmv{l}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{head} \, \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{tail} \, \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\lambda  \ottmv{x}  \ottsym{.}  \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{let} \, \ottnt{pat}  \ottsym{=}  \ottnt{e_{{\mathrm{1}}}} \, \ottkw{in} \, \ottnt{e_{{\mathrm{2}}}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{case} \, \ottnt{e} \, \ottkw{of} \, \ottsym{\{l1}  \leftarrow  \ottsym{e1,}  \ottsym{..,}  \ottmv{l_{\ottmv{n}}}  \leftarrow  \ottsym{en\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{`}  \ottmv{l}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{=}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{=}  \ottnt{e_{\ottmv{n}}}  \ottsym{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{[}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{e_{\ottmv{n}}}  \ottsym{]}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{e}  \ottsym{:}  \sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{e}  \mathbin{@}  \sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{e}  \ottsym{)}} {\textsf{S}}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{e}  \ottsym{[}  \ottnt{e'}  \ottsym{/}  \ottmv{x}  \ottsym{]}} {\textsf{M}}{}{}{}}

\newcommand{\otth}{
\ottrulehead{\ottnt{h}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{null}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{x}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{e}  \ottsym{.}  \ottmv{l}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{head} \, \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{tail} \, \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\lambda  \ottmv{x}  \ottsym{.}  \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{let} \, \ottnt{pat}  \ottsym{=}  \ottnt{e_{{\mathrm{1}}}} \, \ottkw{in} \, \ottnt{e_{{\mathrm{2}}}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{case} \, \ottnt{e} \, \ottkw{of} \, \ottsym{\{l1}  \leftarrow  \ottsym{e1,}  \ottsym{..,}  \ottmv{l_{\ottmv{n}}}  \leftarrow  \ottsym{en\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{`}  \ottmv{l}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{=}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{=}  \ottnt{e_{\ottmv{n}}}  \ottsym{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{[}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{e_{\ottmv{n}}}  \ottsym{]}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{e}  \ottsym{:}  \sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{e}  \mathbin{@}  \sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{h}  \ottsym{)}} {\textsf{S}}{}{}{}}

\newcommand{\ottvalue}{
\ottrulehead{\ottnt{value}  ,\ \ottnt{v}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\lambda  \ottmv{x}  \ottsym{.}  \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{null}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{=}  \ottnt{v_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{=}  \ottnt{v_{\ottmv{n}}}  \ottsym{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{[}  \ottnt{v_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{v_{\ottmv{n}}}  \ottsym{]}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{`}  \ottmv{l}}{}{}{}{}}

\newcommand{\ottwhnf}{
\ottrulehead{\ottnt{whnf}  ,\ \ottnt{w}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\lambda  \ottmv{x}  \ottsym{.}  \ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{null}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{`}  \ottmv{l}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{=}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{=}  \ottnt{e_{\ottmv{n}}}  \ottsym{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{[}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{e_{\ottmv{n}}}  \ottsym{]}}{}{}{}{}}

\newcommand{\ottpat}{
\ottrulehead{\ottnt{pat}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottmv{x}}{}{}{}{}}

\newcommand{\ottbindings}{
\ottrulehead{\ottnt{bindings}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottmv{x_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, ... \, \ottsym{,}  \ottmv{x_{\ottmv{n}}}  \ottsym{:}  \sigma_{\ottmv{n}}}{}{}{}{}}

\newcommand{\ottC}{
\ottrulehead{\ottnt{C}  ,\ \ottnt{U}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\sigma  \ottsym{<:}  \tau}{}{}{}{}\ottprodnewline
\ottprodline{|}{{?a}  \ottsym{=}  \sigma}{}{}{}{}}

\newcommand{\ottconstraints}{
\ottrulehead{\ottnt{constraints}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{C_{{\mathrm{1}}}}  \ottsym{,} \, ... \, \ottsym{,}  \ottnt{C_{\ottmv{n}}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{constraints}  \ottsym{)}} {\textsf{S}}{}{}{}}

\newcommand{\ottCcontext}{
\ottrulehead{\Xi}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{empty}}{}{}{}{}\ottprodnewline
\ottprodline{|}{ \Xi,  \ottnt{constraints} }{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \Xi  \ottsym{)}} {\textsf{S}}{}{}{}}

\newcommand{\ottG}{
\ottrulehead{\Gamma}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{empty}}{}{}{}{}\ottprodnewline
\ottprodline{|}{ \Gamma,  \ottnt{bindings} }{}{}{}{}}

\newcommand{\otttypebindings}{
\ottrulehead{\ottnt{typebindings}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\alpha_{{\mathrm{1}}} \, ... \, \alpha_{\ottmv{n}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\theta_{{\mathrm{1}}} \, ... \, \theta_{\ottmv{n}}}{}{}{}{}}

\newcommand{\ottPsi}{
\ottrulehead{\Psi}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottkw{empty}}{}{}{}{}\ottprodnewline
\ottprodline{|}{ \Psi,  \ottnt{typebindings} }{}{}{}{}}

\newcommand{\ottformula}{
\ottrulehead{\ottnt{formula}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{judgement}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{bindings} \, \in \, \Gamma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typebindings} \, \in \, \Psi}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{n}  \leq  \ottmv{m}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma \, \text{not a variable}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma \, {\neq {?a} }}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{C} \, \text{is solved}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Xi \, \text{is solved}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{max} \, \sigma_{{\mathrm{1}}} \, ... \, \sigma_{\ottmv{n}}  \ottsym{=}  \sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{max} \, \sigma_{{\mathrm{1}}} \, ... \, \sigma_{\ottmv{n}}  \ottsym{=} \, \bot}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{C} \, \not\in \, \Xi}{}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma  \ottsym{=}  \tau}{}{}{}{}\ottprodnewline
\ottprodline{|}{\exists \, \ottmv{i}  \ottsym{.}  \ottnt{formula}}{}{}{}{}}

\newcommand{\ottterminals}{
\ottrulehead{\ottnt{terminals}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{ \to }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \leftarrow }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \lambda }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \forall }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \exists }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \vdash }{}{}{}{}\ottprodnewline
\ottprodline{|}{ {\color{red}\Rightarrow} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \twoheadrightarrow }{}{}{}{}\ottprodnewline
\ottprodline{|}{ {\color{red}\Rightarrow}^h }{}{}{}{}\ottprodnewline
\ottprodline{|}{ {\color{blue}\Leftarrow} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ {\color{blue}\Leftarrow}^\forall }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \rightsquigarrow }{}{}{}{}\ottprodnewline
\ottprodline{|}{ {:} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \in }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \longrightarrow }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \ldots }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \mid }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \mathbin{@} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \leq }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \text{not a variable} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ {\neq {?a} } }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \text{is solved} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \bot }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \not\in }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \lor }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \land }{}{}{}{}}

\newcommand{\ottJstlc}{
\ottrulehead{\ottnt{Jstlc}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\Psi  \vdash  \sigma_{{\mathrm{1}}}  \ottsym{<:}  \sigma_{{\mathrm{2}}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma  \vdash  \ottnt{e} \, {:} \, \sigma}{}{}{}{\ottcom{Well-typed expressions}}\ottprodnewline
\ottprodline{|}{\Gamma  \vdash  \ottnt{h} \, {\color{red}\Rightarrow}^h \, \sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma  \vdash  \ottnt{e} \, {\color{red}\Rightarrow} \, \sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma  \vdash  \ottnt{e} \, {\color{blue}\Leftarrow} \, \sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma  \vdash  \ottnt{e} \, \rightsquigarrow \, \ottsym{t1,}  \ottsym{..,}  \ottsym{tn,}  \rho}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Psi  \ottsym{,}  \Xi \, \twoheadrightarrow \, \Xi'}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottkw{max} \, \sigma_{{\mathrm{1}}} \, .. \, \sigma_{\ottmv{n}}  \ottsym{=}  \tau}{}{}{}{}}

\newcommand{\ottjudgement}{
\ottrulehead{\ottnt{judgement}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottnt{Jstlc}}{}{}{}{}}

\newcommand{\ottuserXXsyntax}{
\ottrulehead{\ottnt{user\_syntax}}{::=}{}\ottprodnewline
\ottfirstprodline{|}{\ottmv{var}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{uvar}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{labels}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{typevar}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{rowvar}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{i}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{type\_vars}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{row\_vars}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho}{}{}{}{}\ottprodnewline
\ottprodline{|}{\chi}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{rows}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{rows\_enum}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho}{}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{rows\_unif}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\rho}{}{}{}{}\ottprodnewline
\ottprodline{|}{\sigma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{e}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{h}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{value}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{whnf}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{pat}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{bindings}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{C}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{constraints}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Xi}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{typebindings}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Psi}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{formula}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{terminals}}{}{}{}{}}

\newcommand{\ottgrammar}{\ottgrammartabular{
\otttypeXXvars\ottinterrule
\ottrowXXvars\ottinterrule
\ottrowsXXnotail\ottinterrule
\ottrowsXXenumXXnotail\ottinterrule
\ottrows\ottinterrule
\ottrowsXXenum\ottinterrule
\otttXXmono\ottinterrule
\ottt\ottinterrule
\ottrowsXXnotailXXunif\ottinterrule
\ottrowsXXunif\ottinterrule
\otttXXunifXXmono\ottinterrule
\otttXXunif\ottinterrule
\otte\ottinterrule
\otth\ottinterrule
\ottvalue\ottinterrule
\ottwhnf\ottinterrule
\ottpat\ottinterrule
\ottbindings\ottinterrule
\ottC\ottinterrule
\ottconstraints\ottinterrule
\ottCcontext\ottinterrule
\ottG\ottinterrule
\otttypebindings\ottinterrule
\ottPsi\ottinterrule
\ottformula\ottinterrule
\ottterminals\ottinterrule
\ottJstlc\ottinterrule
\ottjudgement\ottinterrule
\ottuserXXsyntax\ottafterlastrule
}}

% defnss
% defns Jstlc
%% defn subtyping
\newcommand{\ottdruleSubXXReflVar}[1]{\ottdrule[#1]{%
\ottpremise{\alpha \, \in \, \Psi}%
}{
\Psi  \vdash   \alpha   \ottsym{<:}   \alpha }{%
{\ottdrulename{Sub\_ReflVar}}{}%
}}


\newcommand{\ottdruleSubXXReflRowVar}[1]{\ottdrule[#1]{%
\ottpremise{\theta \, \in \, \Psi}%
}{
\Psi  \vdash   \theta   \ottsym{<:}   \theta }{%
{\ottdrulename{Sub\_ReflRowVar}}{}%
}}


\newcommand{\ottdruleSubXXReflForall}[1]{\ottdrule[#1]{%
}{
\Psi  \vdash   \forall \alpha_{{\mathrm{1}}} \, ... \, \alpha_{\ottmv{n}} {.} \rho   \ottsym{<:}   \forall \alpha_{{\mathrm{1}}} \, ... \, \alpha_{\ottmv{n}} {.} \rho }{%
{\ottdrulename{Sub\_ReflForall}}{}%
}}


\newcommand{\ottdruleSubXXReflForallRow}[1]{\ottdrule[#1]{%
}{
\Psi  \vdash   \forall \theta_{{\mathrm{1}}} \, ... \, \theta_{\ottmv{n}} {.} \rho   \ottsym{<:}   \forall \theta_{{\mathrm{1}}} \, ... \, \theta_{\ottmv{n}} {.} \rho }{%
{\ottdrulename{Sub\_ReflForallRow}}{}%
}}


\newcommand{\ottdruleSubXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{\Psi  \vdash  \sigma_{{\mathrm{3}}}  \ottsym{<:}  \sigma_{{\mathrm{1}}}}%
\ottpremise{\Psi  \vdash  \sigma_{{\mathrm{2}}}  \ottsym{<:}  \sigma_{{\mathrm{4}}}}%
}{
\Psi  \vdash   \sigma_{{\mathrm{1}}}  \to  \sigma_{{\mathrm{2}}}   \ottsym{<:}   \sigma_{{\mathrm{3}}}  \to  \sigma_{{\mathrm{4}}} }{%
{\ottdrulename{Sub\_Arrow}}{}%
}}


\newcommand{\ottdruleSubXXDyn}[1]{\ottdrule[#1]{%
\ottpremise{\sigma \, \text{not a variable}}%
}{
\Psi  \vdash  \sigma  \ottsym{<:}   \ottkw{Dyn} }{%
{\ottdrulename{Sub\_Dyn}}{}%
}}


\newcommand{\ottdruleSubXXArray}[1]{\ottdrule[#1]{%
\ottpremise{\Psi  \vdash  \sigma  \ottsym{<:}  \tau }%
}{
\Psi  \vdash   \ottkw{Array} \, \sigma   \ottsym{<:}   \ottkw{Array} \, \tau  }{%
{\ottdrulename{Sub\_Array}}{}%
}}


\newcommand{\ottdruleSubXXDynRecordOne}[1]{\ottdrule[#1]{%
\ottpremise{\Psi  \vdash  \sigma  \ottsym{<:}  \tau }%
}{
\Psi  \vdash   \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \sigma  \ottsym{\}}   \ottsym{<:}   \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \tau   \ottsym{\}} }{%
{\ottdrulename{Sub\_DynRecord1}}{}%
}}


\newcommand{\ottdruleSubXXRecord}[1]{\ottdrule[#1]{%
\ottpremise{\Psi  \vdash  \sigma_{\ottmv{i}}  \ottsym{<:}  \tau _{\ottmv{i}}}%
}{
\Psi  \vdash   \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{:}  \sigma_{\ottmv{n}}  \ottsym{\}}   \ottsym{<:}   \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \tau _{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{:}  \tau _{\ottmv{n}}  \ottsym{\}} }{%
{\ottdrulename{Sub\_Record}}{}%
}}


\newcommand{\ottdruleSubXXDynTail}[1]{\ottdrule[#1]{%
\ottpremise{\Psi  \vdash  \sigma_{\ottmv{i}}  \ottsym{<:}  \tau _{\ottmv{i}}}%
}{
\Psi  \vdash   \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{:}  \sigma_{\ottmv{n}}  \ottsym{,}  \ottmv{l'_{{\mathrm{1}}}}  \ottsym{:}  \sigma'_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l'_{\ottmv{m}}}  \ottsym{:}  \sigma'_{\ottmv{m}}  \ottsym{\}}   \ottsym{<:}   \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \tau _{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{:}  \tau _{\ottmv{n}}  \mid \, \ottkw{Dyn}  \ottsym{\}} }{%
{\ottdrulename{Sub\_DynTail}}{}%
}}


\newcommand{\ottdruleSubXXDynRecordTwo}[1]{\ottdrule[#1]{%
\ottpremise{\Psi  \vdash  \sigma_{\ottmv{i}}  \ottsym{<:}  \tau }%
}{
\Psi  \vdash   \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{:}  \sigma_{\ottmv{n}}  \ottsym{\}}   \ottsym{<:}   \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \tau   \ottsym{\}} }{%
{\ottdrulename{Sub\_DynRecord2}}{}%
}}

\newcommand{\ottdefnsubtyping}[1]{\begin{ottdefnblock}[#1]{$\Psi  \vdash  \sigma_{{\mathrm{1}}}  \ottsym{<:}  \sigma_{{\mathrm{2}}}$}{}
\ottusedrule{\ottdruleSubXXReflVar{}}
\ottusedrule{\ottdruleSubXXReflRowVar{}}
\ottusedrule{\ottdruleSubXXReflForall{}}
\ottusedrule{\ottdruleSubXXReflForallRow{}}
\ottusedrule{\ottdruleSubXXArrow{}}
\ottusedrule{\ottdruleSubXXDyn{}}
\ottusedrule{\ottdruleSubXXArray{}}
\ottusedrule{\ottdruleSubXXDynRecordOne{}}
\ottusedrule{\ottdruleSubXXRecord{}}
\ottusedrule{\ottdruleSubXXDynTail{}}
\ottusedrule{\ottdruleSubXXDynRecordTwo{}}
\end{ottdefnblock}}

%% defn type
\newcommand{\ottdruleTXXVar}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \sigma \, \in \, \Gamma}%
}{
\Gamma  \vdash  \ottmv{x} \, {:} \, \sigma}{%
{\ottdrulename{T\_Var}}{}%
}}


\newcommand{\ottdruleTXXAbs}[1]{\ottdrule[#1]{%
\ottpremise{ \Gamma,  \ottmv{x}  \ottsym{:}  \sigma_{{\mathrm{1}}}   \vdash  \ottnt{e} \, {:} \, \sigma_{{\mathrm{2}}}}%
}{
\Gamma  \vdash  \lambda  \ottmv{x}  \ottsym{.}  \ottnt{e} \, {:} \,  \sigma_{{\mathrm{1}}}  \to  \sigma_{{\mathrm{2}}} }{%
{\ottdrulename{T\_Abs}}{}%
}}


\newcommand{\ottdruleTXXLet}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e_{{\mathrm{1}}}} \, {:} \, \sigma_{{\mathrm{1}}}}%
\ottpremise{ \Gamma,  \ottmv{x}  \ottsym{:}  \sigma_{{\mathrm{1}}}   \vdash  \ottnt{e_{{\mathrm{2}}}} \, {:} \, \sigma_{{\mathrm{2}}}}%
}{
\Gamma  \vdash  \ottkw{let} \, \ottmv{x}  \ottsym{=}  \ottnt{e_{{\mathrm{1}}}} \, \ottkw{in} \, \ottnt{e_{{\mathrm{2}}}} \, {:} \, \sigma_{{\mathrm{2}}}}{%
{\ottdrulename{T\_Let}}{}%
}}


\newcommand{\ottdruleTXXGen}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {:} \,  \rho }%
}{
\Gamma  \vdash  \ottnt{e} \, {:} \,  \forall \alpha_{{\mathrm{1}}} \, ... \, \alpha_{\ottmv{n}} {.} \rho }{%
{\ottdrulename{T\_Gen}}{}%
}}


\newcommand{\ottdruleTXXGenRow}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {:} \,  \rho }%
}{
\Gamma  \vdash  \ottnt{e} \, {:} \,  \forall \theta_{{\mathrm{1}}} \, ... \, \theta_{\ottmv{n}} {.} \rho }{%
{\ottdrulename{T\_GenRow}}{}%
}}


\newcommand{\ottdruleTXXInst}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {:} \,  \forall \alpha_{{\mathrm{1}}} \, ... \, \alpha_{\ottmv{n}} {.} \rho }%
}{
\Gamma  \vdash  \ottnt{e} \, {:} \,  \rho   \ottsym{[}  \tau '  \ottsym{/}  \alpha  \ottsym{]}}{%
{\ottdrulename{T\_Inst}}{}%
}}


\newcommand{\ottdruleTXXInstRow}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {:} \,  \forall \theta_{{\mathrm{1}}} \, ... \, \theta_{\ottmv{n}} {.} \rho }%
}{
\Gamma  \vdash  \ottnt{e} \, {:} \,  \rho   \ottsym{[}  \ottnt{rows}  \ottsym{/}  \theta  \ottsym{]}}{%
{\ottdrulename{T\_InstRow}}{}%
}}


\newcommand{\ottdruleTXXRecordI}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e_{\ottmv{i}}} \, {:} \, \sigma_{\ottmv{i}}}%
}{
\Gamma  \vdash  \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{=}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{=}  \ottnt{e_{\ottmv{n}}}  \ottsym{\}} \, {:} \,  \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{:}  \sigma_{\ottmv{n}}  \ottsym{\}} }{%
{\ottdrulename{T\_RecordI}}{}%
}}


\newcommand{\ottdruleTXXDynRecordI}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e_{\ottmv{i}}} \, {:} \, \sigma}%
}{
\Gamma  \vdash  \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{=}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{=}  \ottnt{e_{\ottmv{n}}}  \ottsym{\}} \, {:} \,  \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \sigma  \ottsym{\}} }{%
{\ottdrulename{T\_DynRecordI}}{}%
}}


\newcommand{\ottdruleTXXProj}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {:} \,  \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{:}  \sigma_{\ottmv{n}}  \ottsym{\}} }%
}{
\Gamma  \vdash  \ottnt{e}  \ottsym{.}  \ottmv{l_{\ottmv{i}}} \, {:} \, \sigma_{\ottmv{i}}}{%
{\ottdrulename{T\_Proj}}{}%
}}


\newcommand{\ottdruleTXXDynProj}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {:} \,  \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \sigma  \ottsym{\}} }%
}{
\Gamma  \vdash  \ottnt{e}  \ottsym{.}  \ottmv{l} \, {:} \, \sigma}{%
{\ottdrulename{T\_DynProj}}{}%
}}


\newcommand{\ottdruleTXXCase}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {:} \,  \ottsym{<}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{>} }%
\ottpremise{\Gamma  \vdash  \ottnt{e_{\ottmv{i}}} \, {:} \, \sigma}%
}{
\Gamma  \vdash  \ottkw{case} \, \ottnt{e} \, \ottkw{of} \, \ottsym{\{l1}  \leftarrow  \ottsym{e1,}  \ottsym{..,}  \ottmv{l_{\ottmv{n}}}  \leftarrow  \ottsym{en\}} \, {:} \, \sigma}{%
{\ottdrulename{T\_Case}}{}%
}}


\newcommand{\ottdruleTXXArrayI}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e_{\ottmv{i}}} \, {:} \, \sigma}%
}{
\Gamma  \vdash  \ottsym{[}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{e_{\ottmv{n}}}  \ottsym{]} \, {:} \,  \ottkw{Array} \, \sigma }{%
{\ottdrulename{T\_ArrayI}}{}%
}}


\newcommand{\ottdruleTXXHead}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {:} \,  \ottkw{Array} \, \sigma }%
}{
\Gamma  \vdash  \ottkw{head} \, \ottnt{e} \, {:} \, \sigma}{%
{\ottdrulename{T\_Head}}{}%
}}


\newcommand{\ottdruleTXXTail}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {:} \,  \ottkw{Array} \, \sigma }%
}{
\Gamma  \vdash  \ottkw{tail} \, \ottnt{e} \, {:} \,  \ottkw{Array} \, \sigma }{%
{\ottdrulename{T\_Tail}}{}%
}}


\newcommand{\ottdruleTXXAnnot}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {:} \, \sigma}%
}{
\Gamma  \vdash  \ottsym{(}  \ottnt{e}  \ottsym{:}  \sigma  \ottsym{)} \, {:} \, \sigma}{%
{\ottdrulename{T\_Annot}}{}%
}}


\newcommand{\ottdruleTXXDyn}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottnt{e} \, {:} \,  \ottkw{Dyn} }{%
{\ottdrulename{T\_Dyn}}{}%
}}


\newcommand{\ottdruleTXXEnum}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottsym{`}  \ottmv{l} \, {:} \,  \ottsym{<}  \ottmv{l}  \ottsym{,}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{>} }{%
{\ottdrulename{T\_Enum}}{}%
}}


\newcommand{\ottdruleTXXContract}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottnt{e}  \mathbin{@}  \sigma \, {:} \, \sigma}{%
{\ottdrulename{T\_Contract}}{}%
}}

\newcommand{\ottdefntype}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \vdash  \ottnt{e} \, {:} \, \sigma$}{\ottcom{Well-typed expressions}}
\ottusedrule{\ottdruleTXXVar{}}
\ottusedrule{\ottdruleTXXAbs{}}
\ottusedrule{\ottdruleTXXLet{}}
\ottusedrule{\ottdruleTXXGen{}}
\ottusedrule{\ottdruleTXXGenRow{}}
\ottusedrule{\ottdruleTXXInst{}}
\ottusedrule{\ottdruleTXXInstRow{}}
\ottusedrule{\ottdruleTXXRecordI{}}
\ottusedrule{\ottdruleTXXDynRecordI{}}
\ottusedrule{\ottdruleTXXProj{}}
\ottusedrule{\ottdruleTXXDynProj{}}
\ottusedrule{\ottdruleTXXCase{}}
\ottusedrule{\ottdruleTXXArrayI{}}
\ottusedrule{\ottdruleTXXHead{}}
\ottusedrule{\ottdruleTXXTail{}}
\ottusedrule{\ottdruleTXXAnnot{}}
\ottusedrule{\ottdruleTXXDyn{}}
\ottusedrule{\ottdruleTXXEnum{}}
\ottusedrule{\ottdruleTXXContract{}}
\end{ottdefnblock}}

%% defn infers_head
\newcommand{\ottdruleBidirInfHeadXXVar}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \sigma \, \in \, \Gamma}%
}{
\Gamma  \vdash  \ottmv{x} \, {\color{red}\Rightarrow}^h \, \sigma}{%
{\ottdrulename{BidirInfHead\_Var}}{}%
}}


\newcommand{\ottdruleBidirInfHeadXXProj}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {\color{red}\Rightarrow} \,  \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{:}  \sigma_{\ottmv{n}}  \ottsym{\}} }%
}{
\Gamma  \vdash  \ottnt{e}  \ottsym{.}  \ottmv{l_{\ottmv{i}}} \, {\color{red}\Rightarrow}^h \, \sigma_{\ottmv{i}}}{%
{\ottdrulename{BidirInfHead\_Proj}}{}%
}}


\newcommand{\ottdruleBidirInfHeadXXDynProj}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {\color{red}\Rightarrow} \,  \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \sigma  \ottsym{\}} }%
}{
\Gamma  \vdash  \ottnt{e}  \ottsym{.}  \ottmv{l} \, {\color{red}\Rightarrow}^h \, \sigma}{%
{\ottdrulename{BidirInfHead\_DynProj}}{}%
}}


\newcommand{\ottdruleBidirInfHeadXXHead}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {\color{red}\Rightarrow} \,  \ottkw{Array} \, \sigma }%
}{
\Gamma  \vdash  \ottkw{head} \, \ottnt{e} \, {\color{red}\Rightarrow}^h \, \sigma}{%
{\ottdrulename{BidirInfHead\_Head}}{}%
}}


\newcommand{\ottdruleBidirInfHeadXXTail}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {\color{red}\Rightarrow} \,  \ottkw{Array} \, \sigma }%
}{
\Gamma  \vdash  \ottkw{tail} \, \ottnt{e} \, {\color{red}\Rightarrow}^h \,  \ottkw{Array} \, \sigma }{%
{\ottdrulename{BidirInfHead\_Tail}}{}%
}}


\newcommand{\ottdruleBidirInfHeadXXAnnot}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {\color{blue}\Leftarrow} \, \sigma}%
}{
\Gamma  \vdash  \ottsym{(}  \ottnt{h}  \ottsym{:}  \sigma  \ottsym{)} \, {\color{red}\Rightarrow}^h \, \sigma}{%
{\ottdrulename{BidirInfHead\_Annot}}{}%
}}


\newcommand{\ottdruleBidirInfHeadXXContract}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottnt{e}  \mathbin{@}  \sigma \, {\color{red}\Rightarrow}^h \, \sigma}{%
{\ottdrulename{BidirInfHead\_Contract}}{}%
}}


\newcommand{\ottdruleBidirInfHeadXXInfer}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{h} \, {\color{red}\Rightarrow} \,  \rho }%
}{
\Gamma  \vdash  \ottnt{h} \, {\color{red}\Rightarrow}^h \,  \rho }{%
{\ottdrulename{BidirInfHead\_Infer}}{}%
}}

\newcommand{\ottdefninfersXXhead}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \vdash  \ottnt{h} \, {\color{red}\Rightarrow}^h \, \sigma$}{}
\ottusedrule{\ottdruleBidirInfHeadXXVar{}}
\ottusedrule{\ottdruleBidirInfHeadXXProj{}}
\ottusedrule{\ottdruleBidirInfHeadXXDynProj{}}
\ottusedrule{\ottdruleBidirInfHeadXXHead{}}
\ottusedrule{\ottdruleBidirInfHeadXXTail{}}
\ottusedrule{\ottdruleBidirInfHeadXXAnnot{}}
\ottusedrule{\ottdruleBidirInfHeadXXContract{}}
\ottusedrule{\ottdruleBidirInfHeadXXInfer{}}
\end{ottdefnblock}}

%% defn infers
\newcommand{\ottdruleBidirInfXXApp}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{h} \, \ottnt{e_{{\mathrm{1}}}} \, .. \, \ottnt{e_{\ottmv{n}}} \, \rightsquigarrow \, \ottsym{t1,}  \ottsym{..,}  \ottsym{tn,}  \rho}%
\ottpremise{\Gamma  \vdash  \ottnt{e_{\ottmv{i}}} \, {\color{blue}\Leftarrow} \, \sigma_{\ottmv{i}}}%
}{
\Gamma  \vdash  \ottnt{h} \, \ottnt{e_{{\mathrm{1}}}} \, .. \, \ottnt{e_{\ottmv{n}}} \, {\color{red}\Rightarrow} \,  \rho }{%
{\ottdrulename{BidirInf\_App}}{}%
}}


\newcommand{\ottdruleBidirInfXXCase}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {\color{blue}\Leftarrow} \,  \ottsym{<}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{>} }%
\ottpremise{\Gamma  \vdash  \ottnt{e_{\ottmv{i}}} \, {\color{red}\Rightarrow} \,  \rho }%
}{
\Gamma  \vdash  \ottkw{case} \, \ottnt{e} \, \ottkw{of} \, \ottsym{\{l1}  \leftarrow  \ottsym{e1,}  \ottsym{..,}  \ottmv{l_{\ottmv{n}}}  \leftarrow  \ottsym{en\}} \, {\color{red}\Rightarrow} \,  \rho }{%
{\ottdrulename{BidirInf\_Case}}{}%
}}


\newcommand{\ottdruleBidirInfXXNull}[1]{\ottdrule[#1]{%
}{
\Gamma  \vdash  \ottkw{null} \, {\color{red}\Rightarrow} \,  \ottkw{Dyn} }{%
{\ottdrulename{BidirInf\_Null}}{}%
}}

\newcommand{\ottdefninfers}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \vdash  \ottnt{e} \, {\color{red}\Rightarrow} \, \sigma$}{}
\ottusedrule{\ottdruleBidirInfXXApp{}}
\ottusedrule{\ottdruleBidirInfXXCase{}}
\ottusedrule{\ottdruleBidirInfXXNull{}}
\end{ottdefnblock}}

%% defn checks
\newcommand{\ottdruleBidirCheckXXGen}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {\color{blue}\Leftarrow} \,  \rho }%
}{
\Gamma  \vdash  \ottnt{e} \, {\color{blue}\Leftarrow} \,  \forall \alpha_{{\mathrm{1}}} \, ... \, \alpha_{\ottmv{n}} {.} \rho }{%
{\ottdrulename{BidirCheck\_Gen}}{}%
}}


\newcommand{\ottdruleBidirCheckXXGenRow}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {\color{blue}\Leftarrow} \,  \rho }%
}{
\Gamma  \vdash  \ottnt{e} \, {\color{blue}\Leftarrow} \,  \forall \theta_{{\mathrm{1}}} \, ... \, \theta_{\ottmv{n}} {.} \rho }{%
{\ottdrulename{BidirCheck\_GenRow}}{}%
}}


\newcommand{\ottdruleBidirCheckXXAbs}[1]{\ottdrule[#1]{%
\ottpremise{ \Gamma,  \ottmv{x}  \ottsym{:}  \sigma_{{\mathrm{1}}}   \vdash  \ottnt{e} \, {\color{blue}\Leftarrow} \, \sigma_{{\mathrm{2}}}}%
}{
\Gamma  \vdash  \lambda  \ottmv{x}  \ottsym{.}  \ottnt{e} \, {\color{blue}\Leftarrow} \,  \sigma_{{\mathrm{1}}}  \to  \sigma_{{\mathrm{2}}} }{%
{\ottdrulename{BidirCheck\_Abs}}{}%
}}


\newcommand{\ottdruleBidirCheckXXLet}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e_{{\mathrm{1}}}} \, {\color{red}\Rightarrow} \, \sigma}%
\ottpremise{ \Gamma,  \ottmv{x}  \ottsym{:}  \sigma   \vdash  \ottnt{e_{{\mathrm{2}}}} \, {\color{blue}\Leftarrow} \,  \rho }%
}{
\Gamma  \vdash  \ottkw{let} \, \ottmv{x}  \ottsym{=}  \ottnt{e_{{\mathrm{1}}}} \, \ottkw{in} \, \ottnt{e_{{\mathrm{2}}}} \, {\color{blue}\Leftarrow} \,  \rho }{%
{\ottdrulename{BidirCheck\_Let}}{}%
}}


\newcommand{\ottdruleBidirCheckXXApp}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{h} \, \ottnt{e_{{\mathrm{1}}}} \, .. \, \ottnt{e_{\ottmv{n}}} \, \rightsquigarrow \, \ottsym{t1,}  \ottsym{..,}  \ottsym{tn,}  \rho}%
\ottpremise{\Gamma  \vdash  \ottnt{e_{\ottmv{i}}} \, {\color{blue}\Leftarrow} \, \sigma_{\ottmv{i}}}%
}{
\Gamma  \vdash  \ottnt{h} \, \ottnt{e_{{\mathrm{1}}}} \, .. \, \ottnt{e_{\ottmv{n}}} \, {\color{blue}\Leftarrow} \,  \rho }{%
{\ottdrulename{BidirCheck\_App}}{}%
}}


\newcommand{\ottdruleBidirCheckXXCase}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {\color{blue}\Leftarrow} \,  \ottsym{<}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{>} }%
\ottpremise{\Gamma  \vdash  \ottnt{e_{\ottmv{i}}} \, {\color{blue}\Leftarrow} \,  \rho }%
}{
\Gamma  \vdash  \ottkw{case} \, \ottnt{e} \, \ottkw{of} \, \ottsym{\{l1}  \leftarrow  \ottsym{e1,}  \ottsym{..,}  \ottmv{l_{\ottmv{n}}}  \leftarrow  \ottsym{en\}} \, {\color{blue}\Leftarrow} \,  \rho }{%
{\ottdrulename{BidirCheck\_Case}}{}%
}}


\newcommand{\ottdruleBidirCheckXXRecord}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e_{\ottmv{i}}} \, {\color{blue}\Leftarrow} \, \sigma_{\ottmv{i}}}%
}{
\Gamma  \vdash  \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{=}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{=}  \ottnt{e_{\ottmv{n}}}  \ottsym{\}} \, {\color{blue}\Leftarrow} \,  \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{:}  \sigma_{\ottmv{n}}  \ottsym{\}} }{%
{\ottdrulename{BidirCheck\_Record}}{}%
}}


\newcommand{\ottdruleBidirCheckXXDynRecord}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e_{\ottmv{i}}} \, {\color{blue}\Leftarrow} \, \sigma}%
}{
\Gamma  \vdash  \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{=}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{n}}}  \ottsym{=}  \ottnt{e_{\ottmv{n}}}  \ottsym{\}} \, {\color{blue}\Leftarrow} \,  \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \sigma  \ottsym{\}} }{%
{\ottdrulename{BidirCheck\_DynRecord}}{}%
}}


\newcommand{\ottdruleBidirCheckXXArray}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e_{\ottmv{i}}} \, {\color{blue}\Leftarrow} \, \sigma}%
}{
\Gamma  \vdash  \ottsym{[}  \ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{e_{\ottmv{n}}}  \ottsym{]} \, {\color{blue}\Leftarrow} \,  \ottkw{Array} \, \sigma }{%
{\ottdrulename{BidirCheck\_Array}}{}%
}}


\newcommand{\ottdruleBidirCheckXXSub}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, {\color{red}\Rightarrow} \,  \rho_{{\mathrm{1}}} }%
\ottpremise{\Psi  \vdash   \rho_{{\mathrm{1}}}   \ottsym{<:}   \rho_{{\mathrm{2}}} }%
}{
\Gamma  \vdash  \ottnt{e} \, {\color{blue}\Leftarrow} \,  \rho_{{\mathrm{2}}} }{%
{\ottdrulename{BidirCheck\_Sub}}{}%
}}

\newcommand{\ottdefnchecks}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \vdash  \ottnt{e} \, {\color{blue}\Leftarrow} \, \sigma$}{}
\ottusedrule{\ottdruleBidirCheckXXGen{}}
\ottusedrule{\ottdruleBidirCheckXXGenRow{}}
\ottusedrule{\ottdruleBidirCheckXXAbs{}}
\ottusedrule{\ottdruleBidirCheckXXLet{}}
\ottusedrule{\ottdruleBidirCheckXXApp{}}
\ottusedrule{\ottdruleBidirCheckXXCase{}}
\ottusedrule{\ottdruleBidirCheckXXRecord{}}
\ottusedrule{\ottdruleBidirCheckXXDynRecord{}}
\ottusedrule{\ottdruleBidirCheckXXArray{}}
\ottusedrule{\ottdruleBidirCheckXXSub{}}
\end{ottdefnblock}}

%% defn inst_as

\newcommand{\ottdefninstXXas}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \vdash  \ottnt{e} \, \rightsquigarrow \, \ottsym{t1,}  \ottsym{..,}  \ottsym{tn,}  \rho$}{}
\end{ottdefnblock}}

%% defn constr_solves
\newcommand{\ottdruleConstrSolvesXXRefl}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,  \sigma  \ottsym{<:}  \sigma  \, \twoheadrightarrow \, \Xi}{%
{\ottdrulename{ConstrSolves\_Refl}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXVarUnif}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   {?a}   \ottsym{<:}   \alpha   \, \twoheadrightarrow \,  \Xi,  {?a}  \ottsym{=}   \alpha  }{%
{\ottdrulename{ConstrSolves\_VarUnif}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXRowVarUnif}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   {?a}   \ottsym{<:}   \theta   \, \twoheadrightarrow \,  \Xi,  {?a}  \ottsym{=}   \theta  }{%
{\ottdrulename{ConstrSolves\_RowVarUnif}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXForallUnif}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   {?a}   \ottsym{<:}   \forall \alpha_{{\mathrm{1}}} \, .. \, \alpha_{\ottmv{n}} {.} \rho   \, \twoheadrightarrow \,  \Xi,  {?a}  \ottsym{=}   \forall \alpha_{{\mathrm{1}}} \, .. \, \alpha_{\ottmv{n}} {.} \rho  }{%
{\ottdrulename{ConstrSolves\_ForallUnif}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXForallRowUnif}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   {?a}   \ottsym{<:}   \forall \alpha_{{\mathrm{1}}} \, .. \, \alpha_{\ottmv{n}} {.} \rho   \, \twoheadrightarrow \,  \Xi,  {?a}  \ottsym{=}   \forall \alpha_{{\mathrm{1}}} \, .. \, \alpha_{\ottmv{n}} {.} \rho  }{%
{\ottdrulename{ConstrSolves\_ForallRowUnif}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXArrowUnif}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   {?a}   \ottsym{<:}   \sigma_{{\mathrm{1}}}  \to  \sigma_{{\mathrm{2}}}   \, \twoheadrightarrow \,  \Xi,  \ottsym{(}  \sigma_{{\mathrm{1}}}  \ottsym{<:}   {?a}_{{\mathrm{1}}}   \ottsym{,}   {?a}_{{\mathrm{2}}}   \ottsym{<:}  \sigma_{{\mathrm{2}}}  \ottsym{,}  {?a}  \ottsym{=}    {?a}_{{\mathrm{1}}}   \to   {?a}_{{\mathrm{2}}}    \ottsym{)} }{%
{\ottdrulename{ConstrSolves\_ArrowUnif}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXArrayUnif}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   {?a}   \ottsym{<:}   \ottkw{Array} \, \sigma   \, \twoheadrightarrow \,  \Xi,  \ottsym{(}   {?b}   \ottsym{<:}  \sigma  \ottsym{,}  {?a}  \ottsym{=}   \ottkw{Array} \,  {?b}    \ottsym{)} }{%
{\ottdrulename{ConstrSolves\_ArrayUnif}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXRecordUnif}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   {?a}   \ottsym{<:}   \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{i}}}  \ottsym{:}  \sigma_{\ottmv{i}}  \ottsym{\}}   \, \twoheadrightarrow \,  \Xi,  \ottsym{(}   {?b}_{{\mathrm{1}}}   \ottsym{<:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}   {?b}_{\ottmv{i}}   \ottsym{<:}  \sigma_{\ottmv{i}}  \ottsym{,}  {?a}  \ottsym{=}   \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}   {?b}_{{\mathrm{1}}}   \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{i}}}  \ottsym{:}   {?b}_{\ottmv{i}}   \ottsym{\}}   \ottsym{)} }{%
{\ottdrulename{ConstrSolves\_RecordUnif}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXDynRecordUnif}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   {?a}   \ottsym{<:}   \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \sigma  \ottsym{\}}   \, \twoheadrightarrow \,  \Xi,  \ottsym{(}   {?a}_{{\mathrm{1}}}   \ottsym{<:}  \sigma  \ottsym{,}  {?a}  \ottsym{=}   \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}   {?a}_{{\mathrm{1}}}   \ottsym{\}}   \ottsym{)} }{%
{\ottdrulename{ConstrSolves\_DynRecordUnif}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXVar}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,  \sigma  \ottsym{<:}  \sigma  \, \twoheadrightarrow \, \Xi}{%
{\ottdrulename{ConstrSolves\_Var}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXDyn}[1]{\ottdrule[#1]{%
\ottpremise{\sigma \, \text{not a variable}}%
\ottpremise{\sigma \, {\neq {?a} }}%
}{
\Psi  \ottsym{,}   \Xi,  \sigma  \ottsym{<:}   \ottkw{Dyn}   \, \twoheadrightarrow \, \Xi}{%
{\ottdrulename{ConstrSolves\_Dyn}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXLowerDyn}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   \ottkw{Dyn}   \ottsym{<:}   {?a}   \, \twoheadrightarrow \,  \Xi,  {?a}  \ottsym{=}   \ottkw{Dyn}  }{%
{\ottdrulename{ConstrSolves\_LowerDyn}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXArray}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   \ottkw{Array} \, \sigma   \ottsym{<:}   \ottkw{Array} \, \tau   \, \twoheadrightarrow \,  \Xi,  \sigma  \ottsym{<:}  \tau }{%
{\ottdrulename{ConstrSolves\_Array}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXDynRecordOne}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \sigma  \ottsym{\}}   \ottsym{<:}   \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \tau   \ottsym{\}}   \, \twoheadrightarrow \,  \Xi,  \sigma  \ottsym{<:}  \tau  }{%
{\ottdrulename{ConstrSolves\_DynRecord1}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXRecord}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{i}}}  \ottsym{:}  \sigma_{\ottmv{i}}  \ottsym{\}}   \ottsym{<:}   \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \tau_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{i}}}  \ottsym{:}  \tau_{\ottmv{i}}  \ottsym{\}}   \, \twoheadrightarrow \,  \Xi,  \sigma_{{\mathrm{1}}}  \ottsym{<:}  \tau_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \sigma_{\ottmv{i}}  \ottsym{<:}  \tau_{\ottmv{i}} }{%
{\ottdrulename{ConstrSolves\_Record}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXDynRecordTwo}[1]{\ottdrule[#1]{%
}{
\Psi  \ottsym{,}   \Xi,   \ottsym{\{}  \ottmv{l_{{\mathrm{1}}}}  \ottsym{:}  \sigma_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottmv{l_{\ottmv{i}}}  \ottsym{:}  \sigma_{\ottmv{i}}  \ottsym{\}}   \ottsym{<:}   \ottsym{\{} \, \ottkw{\_} \, \ottsym{:}  \tau   \ottsym{\}}   \, \twoheadrightarrow \,  \Xi,  \sigma_{{\mathrm{1}}}  \ottsym{<:}  \tau   \ottsym{,} \, .. \, \ottsym{,}  \sigma_{\ottmv{i}}  \ottsym{<:}  \tau  }{%
{\ottdrulename{ConstrSolves\_DynRecord2}}{}%
}}


\newcommand{\ottdruleConstrSolvesXXUpperBound}[1]{\ottdrule[#1]{%
\ottpremise{\Xi \, \text{is solved}}%
\ottpremise{\sigma_{\ottmv{i}} \, {\neq {?a} }}%
\ottpremise{\ottkw{max} \, \sigma_{{\mathrm{1}}} \, .. \, \sigma_{\ottmv{j}}  \ottsym{=}  \tau}%
\ottpremise{ {?a}   \ottsym{<:}  \sigma' \, \not\in \, \Xi}%
\ottpremise{\sigma'  \ottsym{<:}   {?a}  \, \not\in \, \Xi}%
}{
\Psi  \ottsym{,}   \Xi,  \ottsym{(}  \sigma_{{\mathrm{1}}}  \ottsym{<:}   {?a}   \ottsym{,} \, .. \, \ottsym{,}  \sigma_{\ottmv{i}}  \ottsym{<:}   {?a}   \ottsym{,}   {?a}_{{\mathrm{1}}}   \ottsym{<:}   {?a}   \ottsym{,} \, .. \, \ottsym{,}   {?a}_{\ottmv{j}}   \ottsym{<:}   {?a}   \ottsym{)}  \, \twoheadrightarrow \,  \Xi,  \ottsym{(}   {?a}_{{\mathrm{1}}}   \ottsym{<:}  \tau  \ottsym{,} \, .. \, \ottsym{,}   {?a}_{\ottmv{j}}   \ottsym{<:}  \tau  \ottsym{,}  {?a}  \ottsym{=}  \tau  \ottsym{)} }{%
{\ottdrulename{ConstrSolves\_UpperBound}}{}%
}}

\newcommand{\ottdefnconstrXXsolves}[1]{\begin{ottdefnblock}[#1]{$\Psi  \ottsym{,}  \Xi \, \twoheadrightarrow \, \Xi'$}{}
\ottusedrule{\ottdruleConstrSolvesXXRefl{}}
\ottusedrule{\ottdruleConstrSolvesXXVarUnif{}}
\ottusedrule{\ottdruleConstrSolvesXXRowVarUnif{}}
\ottusedrule{\ottdruleConstrSolvesXXForallUnif{}}
\ottusedrule{\ottdruleConstrSolvesXXForallRowUnif{}}
\ottusedrule{\ottdruleConstrSolvesXXArrowUnif{}}
\ottusedrule{\ottdruleConstrSolvesXXArrayUnif{}}
\ottusedrule{\ottdruleConstrSolvesXXRecordUnif{}}
\ottusedrule{\ottdruleConstrSolvesXXDynRecordUnif{}}
\ottusedrule{\ottdruleConstrSolvesXXVar{}}
\ottusedrule{\ottdruleConstrSolvesXXDyn{}}
\ottusedrule{\ottdruleConstrSolvesXXLowerDyn{}}
\ottusedrule{\ottdruleConstrSolvesXXArray{}}
\ottusedrule{\ottdruleConstrSolvesXXDynRecordOne{}}
\ottusedrule{\ottdruleConstrSolvesXXRecord{}}
\ottusedrule{\ottdruleConstrSolvesXXDynRecordTwo{}}
\ottusedrule{\ottdruleConstrSolvesXXUpperBound{}}
\end{ottdefnblock}}

%% defn max
\newcommand{\ottdruleMaxXXMax}[1]{\ottdrule[#1]{%
\ottpremise{\sigma_{{\mathrm{1}}} \, \lor \, .. \, \lor \, \sigma_{\ottmv{n}}  \ottsym{=}  \tau}%
\ottpremise{\exists \, \ottmv{i}  \ottsym{.}  \sigma_{\ottmv{i}}  \ottsym{=}  \tau}%
}{
\ottkw{max} \, \sigma_{{\mathrm{1}}} \, .. \, \sigma_{\ottmv{n}}  \ottsym{=}  \tau}{%
{\ottdrulename{Max\_Max}}{}%
}}

\newcommand{\ottdefnmax}[1]{\begin{ottdefnblock}[#1]{$\ottkw{max} \, \sigma_{{\mathrm{1}}} \, .. \, \sigma_{\ottmv{n}}  \ottsym{=}  \tau$}{}
\ottusedrule{\ottdruleMaxXXMax{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsJstlc}{
\ottdefnsubtyping{}\ottdefntype{}\ottdefninfersXXhead{}\ottdefninfers{}\ottdefnchecks{}\ottdefninstXXas{}\ottdefnconstrXXsolves{}\ottdefnmax{}}

\newcommand{\ottdefnss}{
\ottdefnsJstlc
}

\newcommand{\ottall}{\ottmetavars\\[0pt]
\ottgrammar\\[5.0mm]
\ottdefnss}

\begin{document}
\ottall

\begin{verbatim}
Definition rules:        69 good    0 bad
Definition rule clauses: 131 good    0 bad
\end{verbatim}
\end{document}
